
import streamlit as st
import time
from textwrap import dedent

def generate_shpora(input_text):
    if not input_text.strip():
        return "–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É."

    prompt = f"""
    –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Ç–µ–∫—Å—Ç —ñ –≤–∏–∫–æ–Ω–∞–π —Ç—Ä–∏ –æ–∫—Ä–µ–º—ñ –∑–∞–≤–¥–∞–Ω–Ω—è:

    1. –ö–õ–Æ–ß–û–í–Ü –í–ò–°–ù–û–í–ö–ò: –°—Ç–∏—Å–Ω–∏ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –¥–æ 5-7 –Ω–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö, –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö —Ä–µ—á–µ–Ω—å. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ "## 1. –ö–ª—é—á–æ–≤—ñ –í–∏—Å–Ω–æ–≤–∫–∏ —Ç–∞ –†–µ–∑—é–º–µ".

    2. –û–°–ù–û–í–ù–Ü –¢–ï–†–ú–Ü–ù–ò: –í–∏–¥—ñ–ª–∏ 5-10 –Ω–∞–π–±—ñ–ª—å—à –≤–∞–∂–ª–∏–≤–∏—Ö —Ç–µ—Ä–º—ñ–Ω—ñ–≤ –∞–±–æ –∫–æ–Ω—Ü–µ–ø—Ü—ñ–π —ñ–∑ —Ç–µ–∫—Å—Ç—É —ñ –¥–∞–π —Å—Ç–∏—Å–ª–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ (–Ω–µ –±—ñ–ª—å—à–µ –æ–¥–Ω–æ–≥–æ —Ä–µ—á–µ–Ω–Ω—è –Ω–∞ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ "## 2. –ì–ª–æ—Å–∞—Ä—ñ–π –û—Å–Ω–æ–≤–Ω–∏—Ö –¢–µ—Ä–º—ñ–Ω—ñ–≤". –§–æ—Ä–º–∞—Ç: "**–¢–µ—Ä–º—ñ–Ω:** –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è.".

    3. –ü–ò–¢–ê–ù–ù–Ø –î–õ–Ø –°–ê–ú–û–ü–ï–†–ï–í–Ü–†–ö–ò: –°—Ñ–æ—Ä–º—É–ª—é–π 5-7 –ø–∏—Ç–∞–Ω—å, —è–∫—ñ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–Ω–∞–Ω—å –∑–∞ —Ü–∏–º —Ç–µ–∫—Å—Ç–æ–º. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ "## 3. –ü–∏—Ç–∞–Ω–Ω—è –¥–ª—è –°–∞–º–æ–ø–µ—Ä–µ–≤—ñ—Ä–∫–∏".

    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –ª–∏—à–µ —É–∫—Ä–∞—ó–Ω—Å—å–∫—É –º–æ–≤—É.

    –û–°–ù–û–í–ù–ò–ô –¢–ï–ö–°–¢ –î–õ–Ø –ê–ù–ê–õ–Ü–ó–£:
    ---
    {input_text}
    ---
    """

    return f"[[LLM_REQUEST_START]]{prompt}"


def main():
    st.set_page_config(layout="wide")
    st.title('üìù –ö–æ–Ω—Å–ø–µ–∫—Ç-–ö–æ–º–ø—Ä–µ—Å–æ—Ä: –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –û—Å–≤—ñ—Ç–Ω—ñ—Ö –®–ø–∞—Ä–≥–∞–ª–æ–∫')
    st.subheader('–ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î –¥–æ–≤–≥–∏–π —Ç–µ–∫—Å—Ç –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π –Ω–∞–≤—á–∞–ª—å–Ω–∏–π –º–∞—Ç–µ—Ä—ñ–∞–ª (LLM-Driven)')

    st.markdown("""
        **–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:** –í—Å—Ç–∞–≤—Ç–µ –≤–µ–ª–∏–∫–∏–π —à–º–∞—Ç–æ–∫ —Ç–µ–∫—Å—Ç—É (–ø–∞—Ä–∞–≥—Ä–∞—Ñ, –≤–∏—Ç—è–≥ —ñ–∑ –∑–∞–∫–æ–Ω—É, –Ω–∞—É–∫–æ–≤—É —Å—Ç–∞—Ç—Ç—é) —É –ø–æ–ª–µ –Ω–∏–∂—á–µ. 
        –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É, —ñ LLM-—è–¥—Ä–æ –≤ –¥—ñ–∞–ª–æ–∑—ñ –∑–≥–µ–Ω–µ—Ä—É—î –¥–ª—è –≤–∞—Å —à–ø–∞—Ä–≥–∞–ª–∫—É.
    """)

    input_text = st.text_area(
        "–í—Å—Ç–∞–≤—Ç–µ —Ç–µ–∫—Å—Ç —Ç—É—Ç:",
        height=300,
        placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: '–ó–∞–∫–æ–Ω –ø—Ä–æ –¥–µ—Ä–∂–∞–≤–Ω—É –ø—ñ–¥—Ç—Ä–∏–º–∫—É ...' –∞–±–æ '–¢–µ–æ—Ä—ñ—è –≤—ñ–¥–Ω–æ—Å–Ω–æ—Å—Ç—ñ –ï–π–Ω—à—Ç–µ–π–Ω–∞...' "
    )

    if st.button('üöÄ –°—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –®–ø–∞—Ä–≥–∞–ª–∫—É'):
        if not input_text.strip():
            st.warning("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤—Å—Ç–∞–≤—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É.")
            return

        with st.spinner('–ê–Ω–∞–ª—ñ–∑ —Ç–µ–∫—Å—Ç—É —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–ø–∏—Ç—É –¥–ª—è LLM...'):
            result = generate_shpora(input_text)

            if result.startswith("[[LLM_REQUEST_START]]"):
                st.success("‚úÖ –ó–∞–ø–∏—Ç —É—Å–ø—ñ—à–Ω–æ —Å—Ñ–æ—Ä–º–æ–≤–∞–Ω–æ. –ü–µ—Ä–µ–¥–∞—é —è–¥—Ä—É LLM (–º–æ—î–º—É –º–æ–∑–∫—É)...")
                st.markdown("---")
                st.markdown("### –ó–∞–ø–∏—Ç –¥–æ LLM (–í–∏–∫–æ–Ω–∞–π—Ç–µ —Ü—é –∂–æ—Ä—Å—Ç–∫—É –∫–æ–º–∞–Ω–¥—É –≤ —á–∞—Ç—ñ):")

                final_prompt = result.replace("[[LLM_REQUEST_START]]", "")
                st.code(final_prompt, language="markdown")
                st.warning("–ö–û–õ–ò –í–ò –ë–ê–ß–ò–¢–ï –¶–ï–ô –ï–ö–†–ê–ù: **–°–∫–æ–ø—ñ—é–π—Ç–µ –≤–º—ñ—Å—Ç –±–ª–æ–∫—É '–ó–∞–ø–∏—Ç –¥–æ LLM' —ñ –≤—Å—Ç–∞–≤—Ç–µ –π–æ–≥–æ –º–µ–Ω—ñ –≤ —á–∞—Ç —è–∫ –æ–∫—Ä–µ–º–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è.** –Ø –≤—ñ–¥–ø–æ–≤—ñ–º –≥–æ—Ç–æ–≤–æ—é —à–ø–∞—Ä–≥–∞–ª–∫–æ—é.")

            else:
                st.error("–ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –∑–∞–ø–∏—Ç—É.")
                st.info(result)


if __name__ == '__main__':
    main()
